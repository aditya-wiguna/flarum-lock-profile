{"version":3,"file":"forum.js","mappings":"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","sources":["webpack://@adityawiguna/flarum-lock-profile/webpack/bootstrap","webpack://@adityawiguna/flarum-lock-profile/webpack/runtime/compat get default export","webpack://@adityawiguna/flarum-lock-profile/webpack/runtime/define property getters","webpack://@adityawiguna/flarum-lock-profile/webpack/runtime/hasOwnProperty shorthand","webpack://@adityawiguna/flarum-lock-profile/external root \"flarum.core.compat['forum/app']\"","webpack://@adityawiguna/flarum-lock-profile/external root \"flarum.core.compat['common/extend']\"","webpack://@adityawiguna/flarum-lock-profile/external root \"flarum.core.compat['forum/components/SettingsPage']\"","webpack://@adityawiguna/flarum-lock-profile/external root \"flarum.core.compat['forum/components/UserPage']\"","webpack://@adityawiguna/flarum-lock-profile/external root \"flarum.core.compat['forum/components/ChangeEmailModal']\"","webpack://@adityawiguna/flarum-lock-profile/external root \"flarum.core.compat['forum/components/ChangePasswordModal']\"","webpack://@adityawiguna/flarum-lock-profile/external root \"flarum.core.compat['forum/components/UserCard']\"","webpack://@adityawiguna/flarum-lock-profile/external root \"flarum.core.compat['common/components/AvatarEditor']\"","webpack://@adityawiguna/flarum-lock-profile/./src/forum/index.js"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/app'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/extend'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/SettingsPage'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/UserPage'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/ChangeEmailModal'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/ChangePasswordModal'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/UserCard'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/AvatarEditor'];","import app from 'flarum/forum/app';\nimport { extend, override } from 'flarum/common/extend';\nimport UserPage from 'flarum/forum/components/UserPage';\nimport SettingsPage from 'flarum/forum/components/SettingsPage';\nimport ChangeEmailModal from 'flarum/forum/components/ChangeEmailModal';\nimport ChangePasswordModal from 'flarum/forum/components/ChangePasswordModal';\nimport UserCard from 'flarum/forum/components/UserCard';\nimport AvatarEditor from 'flarum/common/components/AvatarEditor';\n\napp.initializers.add('yourvendor/flarum-lock-profile', () => {\n  // Check if user can edit profiles (only admins can)\n  const canEditProfile = () => {\n    return app.session.user && app.session.user.isAdmin();\n  };\n\n  // Hide edit button on user card\n  extend(UserCard.prototype, 'infoItems', function(items) {\n    if (!canEditProfile() && this.attrs.user && this.attrs.user.id() === app.session.user?.id()) {\n      items.remove('edit');\n    }\n  });\n\n  // Disable all profile editing fields in settings\n  extend(SettingsPage.prototype, 'settingsItems', function(items) {\n    if (!canEditProfile()) {\n      // Disable account section\n      if (items.has('account')) {\n        const accountItem = items.get('account');\n        \n        // Override to disable inputs after render\n        extend(SettingsPage.prototype, 'oncreate', function() {\n          setTimeout(() => {\n            this.disableProfileFields();\n          }, 50);\n        });\n      }\n    }\n  });\n\n  // Add method to disable profile fields\n  SettingsPage.prototype.disableProfileFields = function() {\n    if (canEditProfile()) return;\n\n    // Disable username field\n    const usernameInput = document.querySelector('input[name=\"username\"]');\n    if (usernameInput) {\n      usernameInput.disabled = true;\n      usernameInput.style.opacity = '0.6';\n      usernameInput.style.cursor = 'not-allowed';\n      usernameInput.title = 'Profile editing is locked';\n    }\n\n    // Disable email field\n    const emailInput = document.querySelector('input[name=\"email\"]');\n    if (emailInput) {\n      emailInput.disabled = true;\n      emailInput.style.opacity = '0.6';\n      emailInput.style.cursor = 'not-allowed';\n      emailInput.title = 'Profile editing is locked';\n    }\n\n    // Disable bio field\n    const bioField = document.querySelector('textarea[name=\"bio\"]');\n    if (bioField) {\n      bioField.disabled = true;\n      bioField.style.opacity = '0.6';\n      bioField.style.cursor = 'not-allowed';\n      bioField.title = 'Profile editing is locked';\n    }\n\n    // Hide change email button\n    document.querySelectorAll('.Button--changeEmail, button[onclick*=\"email\"]').forEach(btn => {\n      btn.style.display = 'none';\n    });\n\n    // Disable avatar editor\n    const avatarEditors = document.querySelectorAll('.AvatarEditor');\n    avatarEditors.forEach(editor => {\n      editor.style.opacity = '0.6';\n      editor.style.pointerEvents = 'none';\n      editor.style.cursor = 'not-allowed';\n      editor.title = 'Profile editing is locked';\n    });\n\n    // Disable all save buttons in settings\n    const saveButtons = document.querySelectorAll('.SettingsPage .Button--primary[type=\"submit\"]');\n    saveButtons.forEach(btn => {\n      if (btn.textContent.includes('Save')) {\n        btn.disabled = true;\n        btn.style.opacity = '0.6';\n        btn.style.cursor = 'not-allowed';\n      }\n    });\n  };\n\n  // Block avatar editor completely for non-admins\n  override(AvatarEditor.prototype, 'view', function(original) {\n    if (!canEditProfile() && this.attrs.user && this.attrs.user.id() === app.session.user?.id()) {\n      return m('.AvatarEditor', {\n        style: 'opacity: 0.6; pointer-events: none; cursor: not-allowed;',\n        title: 'Profile editing is locked'\n      }, original());\n    }\n    return original();\n  });\n\n  // Prevent change email modal from opening\n  override(ChangeEmailModal.prototype, 'oninit', function(original, vnode) {\n    if (!canEditProfile()) {\n      app.modal.close();\n      app.alerts.show({ type: 'error' }, app.translator.trans('yourvendor-lock-profile.forum.profile_locked'));\n      return;\n    }\n    return original(vnode);\n  });\n\n  // Intercept settings page form submission\n  extend(SettingsPage.prototype, 'onsubmit', function(e) {\n    if (!canEditProfile()) {\n      e.preventDefault();\n      app.alerts.show({ type: 'error' }, app.translator.trans('yourvendor-lock-profile.forum.profile_locked'));\n    }\n  });\n});\n"],"names":["__webpack_require__","module","getter","__esModule","d","a","exports","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","flarum","core","compat","app","add","canEditProfile","user","isAdmin","extend","UserCard","items","_app$session$user","this","attrs","id","remove","SettingsPage","has","_this","setTimeout","disableProfileFields","usernameInput","document","querySelector","disabled","style","opacity","cursor","title","emailInput","bioField","querySelectorAll","forEach","btn","display","editor","pointerEvents","textContent","includes","override","AvatarEditor","original","_app$session$user2","m","ChangeEmailModal","vnode","close","show","type","trans","e","preventDefault"],"sourceRoot":""}