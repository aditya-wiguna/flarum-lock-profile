{"version":3,"file":"forum.js","mappings":"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","sources":["webpack://@adityawiguna/flarum-lock-profile/webpack/bootstrap","webpack://@adityawiguna/flarum-lock-profile/webpack/runtime/compat get default export","webpack://@adityawiguna/flarum-lock-profile/webpack/runtime/define property getters","webpack://@adityawiguna/flarum-lock-profile/webpack/runtime/hasOwnProperty shorthand","webpack://@adityawiguna/flarum-lock-profile/external root \"flarum.core.compat['forum/app']\"","webpack://@adityawiguna/flarum-lock-profile/external root \"flarum.core.compat['common/extend']\"","webpack://@adityawiguna/flarum-lock-profile/external root \"flarum.core.compat['forum/components/SettingsPage']\"","webpack://@adityawiguna/flarum-lock-profile/external root \"flarum.core.compat['forum/components/UserPage']\"","webpack://@adityawiguna/flarum-lock-profile/external root \"flarum.core.compat['forum/components/ChangeEmailModal']\"","webpack://@adityawiguna/flarum-lock-profile/external root \"flarum.core.compat['forum/components/ChangePasswordModal']\"","webpack://@adityawiguna/flarum-lock-profile/external root \"flarum.core.compat['forum/components/UserCard']\"","webpack://@adityawiguna/flarum-lock-profile/external root \"flarum.core.compat['common/components/AvatarEditor']\"","webpack://@adityawiguna/flarum-lock-profile/./src/forum/index.js"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/app'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/extend'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/SettingsPage'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/UserPage'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/ChangeEmailModal'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/ChangePasswordModal'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/UserCard'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/AvatarEditor'];","import app from 'flarum/forum/app';\nimport { extend, override } from 'flarum/common/extend';\nimport UserPage from 'flarum/forum/components/UserPage';\nimport SettingsPage from 'flarum/forum/components/SettingsPage';\nimport ChangeEmailModal from 'flarum/forum/components/ChangeEmailModal';\nimport ChangePasswordModal from 'flarum/forum/components/ChangePasswordModal';\nimport UserCard from 'flarum/forum/components/UserCard';\nimport AvatarEditor from 'flarum/common/components/AvatarEditor';\n\napp.initializers.add('aditya-wiguna/flarum-lock-profile', () => {\n  // LOCK FOR ALL USERS INCLUDING ADMINS\n  const canEditProfile = () => {\n    return false; // Always return false - nobody can edit username/email\n  };\n\n  // Hide edit button on user card\n  extend(UserCard.prototype, 'infoItems', function(items) {\n    if (this.attrs.user && this.attrs.user.id() === app.session.user?.id()) {\n      items.remove('edit');\n    }\n    \n    // Remove the controls dropdown entirely for all users\n    if (items.has('controls')) {\n      items.remove('controls');\n    }\n  });\n\n  // Hide controls dropdown button via DOM manipulation as additional protection\n  extend(UserCard.prototype, 'oncreate', function() {\n    setTimeout(() => {\n      // Hide the dropdown toggle button with ellipsis icon\n      const controlsButtons = document.querySelectorAll('.Dropdown-toggle[aria-label*=\"controls\"], .Dropdown-toggle[data-toggle=\"dropdown\"]');\n      controlsButtons.forEach(btn => {\n        if (btn.textContent.includes('Controls') || btn.querySelector('.fa-ellipsis-v')) {\n          btn.style.display = 'none';\n        }\n      });\n    }, 50);\n  });\n\n  // Disable all profile editing fields in settings\n  extend(SettingsPage.prototype, 'settingsItems', function(items) {\n    // Disable account section for everyone\n    if (items.has('account')) {\n      const accountItem = items.get('account');\n      \n      // Override to disable inputs after render\n      extend(SettingsPage.prototype, 'oncreate', function() {\n        setTimeout(() => {\n          this.disableProfileFields();\n        }, 50);\n      });\n    }\n  });\n\n  // Add method to disable profile fields\n  SettingsPage.prototype.disableProfileFields = function() {\n    // Disable username field for EVERYONE\n    const usernameInput = document.querySelector('input[name=\"username\"]');\n    if (usernameInput) {\n      usernameInput.disabled = true;\n      usernameInput.style.opacity = '0.6';\n      usernameInput.style.cursor = 'not-allowed';\n      usernameInput.title = 'Username editing is locked by administrator';\n    }\n\n    // Disable email field for EVERYONE\n    const emailInput = document.querySelector('input[name=\"email\"]');\n    if (emailInput) {\n      emailInput.disabled = true;\n      emailInput.style.opacity = '0.6';\n      emailInput.style.cursor = 'not-allowed';\n      emailInput.title = 'Email editing is locked by administrator';\n    }\n\n    // Disable bio field\n    const bioField = document.querySelector('textarea[name=\"bio\"]');\n    if (bioField) {\n      bioField.disabled = true;\n      bioField.style.opacity = '0.6';\n      bioField.style.cursor = 'not-allowed';\n      bioField.title = 'Profile editing is locked';\n    }\n\n    // Hide the entire Account fieldset (contains Change Password and Change Email buttons)\n    const accountFieldset = document.querySelector('.Settings-account');\n    if (accountFieldset) {\n      accountFieldset.style.display = 'none';\n    }\n\n    // Also hide individual change email/password buttons as fallback\n    document.querySelectorAll('.Button--changeEmail, .item-changeEmail, .item-changePassword, button[onclick*=\"email\"]').forEach(btn => {\n      btn.style.display = 'none';\n    });\n\n    // Disable avatar editor\n    const avatarEditors = document.querySelectorAll('.AvatarEditor');\n    avatarEditors.forEach(editor => {\n      editor.style.opacity = '0.6';\n      editor.style.pointerEvents = 'none';\n      editor.style.cursor = 'not-allowed';\n      editor.title = 'Profile editing is locked';\n    });\n\n    // Disable all save buttons in settings\n    const saveButtons = document.querySelectorAll('.SettingsPage .Button--primary[type=\"submit\"]');\n    saveButtons.forEach(btn => {\n      if (btn.textContent.includes('Save')) {\n        btn.disabled = true;\n        btn.style.opacity = '0.6';\n        btn.style.cursor = 'not-allowed';\n      }\n    });\n  };\n\n  // Block avatar editor completely\n  override(AvatarEditor.prototype, 'view', function(original) {\n    return m('.AvatarEditor', {\n      style: 'opacity: 0.6; pointer-events: none; cursor: not-allowed;',\n      title: 'Profile editing is locked'\n    }, original());\n  });\n\n  // Prevent change email modal from opening\n  override(ChangeEmailModal.prototype, 'oninit', function(original, vnode) {\n    app.modal.close();\n    app.alerts.show({ type: 'error' }, app.translator.trans('aditya-wiguna-lock-profile.forum.profile_locked'));\n    return;\n  });\n\n  // Intercept settings page form submission\n  extend(SettingsPage.prototype, 'onsubmit', function(e) {\n    e.preventDefault();\n    app.alerts.show({ type: 'error' }, 'Username and email cannot be changed.');\n  });\n});\n"],"names":["__webpack_require__","module","getter","__esModule","d","a","exports","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","flarum","core","compat","app","add","extend","UserCard","items","_app$session$user","this","attrs","user","id","remove","has","setTimeout","document","querySelectorAll","forEach","btn","textContent","includes","querySelector","style","display","SettingsPage","_this","disableProfileFields","usernameInput","disabled","opacity","cursor","title","emailInput","bioField","accountFieldset","editor","pointerEvents","override","AvatarEditor","original","m","ChangeEmailModal","vnode","close","show","type","trans","e","preventDefault"],"sourceRoot":""}